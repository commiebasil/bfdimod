#Wow

shared_focus = {
	id = Musketeers_three_musketeers

	x = 0
	y = 0

	offset = {
		x = 37
		trigger = {
			has_focus_tree = YFC_focus_tree 
		}
	}

	offset = {
		x = 15
		trigger = {
			has_focus_tree = generic_focus_tree 
		}
	}

	icon = GFX_focus_generic

	allow_branch = { 
		has_country_flag = Allow_Musketeers
		is_in_faction = yes
		OR = {
			faction_leader = {tag = YFC}
			faction_leader = {tag = CRN}
		}
	}

	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}	 
		}
	}

	cost = 5

	completion_reward = {
		add_political_power = 50
		add_stability = 0.05

		set_variable = { var_own_trade_opinion_factor = 0.1 }
		set_variable = { var_own_political_power_factor = 0.1 }
		set_variable = { var_own_production_lack_of_resource = 0 }
		set_variable = { var_own_min_export = 0 }
		set_variable = { var_own_consumer_goods_factor = 0 }
		set_variable = { var_own_local_resources_factor = 0 }

		set_variable = { var_udc_army_org_factor = 0.05 }
		set_variable = { var_udc_experience_gain_army_factor = 0.25 }
		set_variable = { var_udc_training_time_factor = 0 }
		set_variable = { var_udc_max_command_power = 0 }
		set_variable = { var_udc_command_power_gain_mult = 0 }
		set_variable = { var_udc_max_planning_factor = 0 }
	}
}

#OWN

joint_focus = {
	id = Musketeers_form_own

	relative_position_id = Musketeers_three_musketeers
	x = -3
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_three_musketeers }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		every_country = {
			limit = {is_in_faction_with = ROOT}
			add_dynamic_modifier = {
				modifier = idea_Musketeers_OWN
			}
		}
	}

	completion_reward_joint_originator = {
		add_stability = 0.05
	}
}

joint_focus = {
	id = Musketeers_grant_drilling_subsidies

	relative_position_id = Musketeers_form_own
	x = -2
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_form_own }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}
	
	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_OWN
		add_to_variable = { var_own_local_resources_factor = 0.15 }
		add_to_variable = { var_own_production_lack_of_resource = -0.05 }
	}

	completion_reward_joint_originator = {
		add_tech_bonus = {
			bonus = 1
			uses = 1
			category = industry
		}
	}
}

joint_focus = {
	id = Musketeers_unite_trading_deals

	relative_position_id = Musketeers_form_own
	x = 2
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_form_own }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_OWN
		add_to_variable = { var_own_trade_opinion_factor = 0.15 }
		add_to_variable = { var_own_min_export = 0.1 }
	}

	completion_reward_joint_originator = {
		add_offsite_building = { type = industrial_complex level = 1 }
	}
}

joint_focus = {
	id = Musketeers_build_new_mines

	relative_position_id = Musketeers_grant_drilling_subsidies
	x = 0
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_grant_drilling_subsidies focus = Musketeers_unite_trading_deals }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_OWN
		add_to_variable = { var_own_local_resources_factor = 0.1 }
		add_to_variable = { var_own_production_lack_of_resource = -0.05 }
	}

	completion_reward_joint_originator = {
		add_tech_bonus = {
			bonus = 1
			uses = 1
			category = industry
		}
	}
}

joint_focus = {
	id = Musketeers_gather_contracts

	relative_position_id = Musketeers_unite_trading_deals
	x = 0
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_grant_drilling_subsidies focus = Musketeers_unite_trading_deals }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_OWN
		add_to_variable = { var_own_trade_opinion_factor = 0.25 }
		add_to_variable = { var_own_min_export = 0.1 }
		add_to_variable = { var_own_consumer_goods_factor = -0.1 }
	}

	completion_reward_joint_originator = {
		add_offsite_building = { type = industrial_complex level = 1 }
	}
}

#UDC

joint_focus = {
	id = Musketeers_form_udc

	relative_position_id = Musketeers_three_musketeers
	x = 3
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_three_musketeers }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		every_country = {
			limit = {is_in_faction_with = ROOT}
			add_dynamic_modifier = {
				modifier = idea_Musketeers_UDC
			}
		}
	}

	completion_reward_joint_originator = {
		army_experience = 25
	}
}	

joint_focus = {
	id = Musketeers_conduct_military_drills 

	relative_position_id = Musketeers_form_udc
	x = -2
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_form_udc }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_UDC
		add_to_variable = { var_udc_training_time_factor = -0.1 }
		add_to_variable = { var_udc_army_org_factor = 0.05 }
	}

	completion_reward_joint_originator = {
		army_experience = 25
	}
}

joint_focus = {
	id = Musketeers_tighten_command 

	relative_position_id = Musketeers_form_udc
	x = 2
	y = 1

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_form_udc }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		custom_effect_tooltip = l_UDC
		add_to_variable = { var_udc_max_command_power = 20 }
		add_to_variable = { var_udc_command_power_gain_mult = 0.25 }
	}

	completion_reward_joint_originator = {
		army_experience = 25
	}
}

joint_focus = {
	id = Musketeers_rules_of_war

	relative_position_id = Musketeers_form_udc
	x = 0
	y = 2

	icon = GFX_focus_generic
	prerequisite = { focus = Musketeers_conduct_military_drills focus = Musketeers_tighten_command }
	available = {
		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			}
		}
	}

	joint_trigger = {
  		hidden_trigger = {
			has_country_flag = Allow_Musketeers
			is_in_faction = yes
			OR = {
				faction_leader = {tag = YFC}
				faction_leader = {tag = CRN}
			} 
		}
	}

	cost = 10

	completion_reward = {
		army_experience = 25
		custom_effect_tooltip = l_UDC
		add_to_variable = { var_udc_max_planning_factor = 0.1 }
	}

	completion_reward_joint_originator = {
		army_experience = 25
		add_doctrine_cost_reduction = {
			cost_reduction = 0.5
			uses = 1
			category = land_doctrine
		}
	}
}
